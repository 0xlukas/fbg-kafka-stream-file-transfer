# =============================================================================
# File Pipeline Integration - Application Configuration
# =============================================================================

# Application name
quarkus.application.name=file-pipeline-integration

# -----------------------------------------------------------------------------
# HTTP Server Configuration
# -----------------------------------------------------------------------------
quarkus.http.port=8080
quarkus.management.enabled=true
quarkus.management.port=9000

# -----------------------------------------------------------------------------
# Camel Configuration
# -----------------------------------------------------------------------------
# Enable YAML DSL routes from classpath
camel.main.routes-include-pattern=classpath:camel/*.yaml

# Route startup
camel.main.startup-recorder=off
camel.main.auto-startup=true

# Thread pool configuration
camel.threadpool.pool-size=10
camel.threadpool.max-pool-size=20
camel.threadpool.max-queue-size=1000

# -----------------------------------------------------------------------------
# ActiveMQ Artemis JMS Configuration
# -----------------------------------------------------------------------------
# Connection URL (overridden in OpenShift via environment variables)
quarkus.artemis.url=tcp://localhost:61616
quarkus.artemis.username=admin
quarkus.artemis.password=admin

# JMS connection pooling
quarkus.artemis.devservices.enabled=true
quarkus.artemis.devservices.port=61616

# Camel JMS component settings
camel.component.jms.connection-factory=#artemisConnectionFactory
camel.component.jms.acknowledgement-mode-name=CLIENT_ACKNOWLEDGE
camel.component.jms.max-concurrent-consumers=5
camel.component.jms.cache-level-name=CACHE_CONSUMER
camel.component.jms.transacted=false

# -----------------------------------------------------------------------------
# AWS S3 Configuration (ODF/NooBaa compatible)
# -----------------------------------------------------------------------------
# Credentials (overridden via environment variables in OpenShift)
quarkus.s3.aws.credentials.type=static
quarkus.s3.aws.credentials.static-provider.access-key-id=minio
quarkus.s3.aws.credentials.static-provider.secret-access-key=minio123

# Endpoint configuration for local/dev (MinIO)
quarkus.s3.endpoint-override=http://localhost:9000
quarkus.s3.aws.region=us-east-1
quarkus.s3.path-style-access=true

# S3 bucket name (overridden via environment variable S3_BUCKET_NAME)
s3.bucket.name=file-pipeline

# Camel S3 component settings
camel.component.aws2-s3.region=us-east-1
camel.component.aws2-s3.uri-endpoint-override=${quarkus.s3.endpoint-override}
camel.component.aws2-s3.override-endpoint=true

# -----------------------------------------------------------------------------
# Docling Service Configuration
# -----------------------------------------------------------------------------
docling.service.url=http://localhost:5001
docling.timeout.ms=300000
docling.retry.max-attempts=3
docling.retry.delay-ms=5000

# Circuit breaker configuration
docling.circuit-breaker.enabled=true
docling.circuit-breaker.failure-ratio=0.5
docling.circuit-breaker.delay-ms=60000
docling.circuit-breaker.success-threshold=3

# -----------------------------------------------------------------------------
# Error Handling Configuration
# -----------------------------------------------------------------------------
# Dead letter queue
error.dlq.name=file-transfer-dlq

# Retry configuration
error.retry.max-attempts=3
error.retry.delay-ms=5000
error.retry.multiplier=2
error.retry.max-delay-ms=60000

# -----------------------------------------------------------------------------
# Health Checks
# -----------------------------------------------------------------------------
quarkus.health.extensions.enabled=true
camel.health.enabled=true
camel.health.routes-enabled=true
camel.health.consumers-enabled=true

# Liveness and readiness
quarkus.smallrye-health.root-path=/q/health

# -----------------------------------------------------------------------------
# Metrics Configuration
# -----------------------------------------------------------------------------
quarkus.micrometer.enabled=true
quarkus.micrometer.export.prometheus.enabled=true
quarkus.micrometer.export.prometheus.path=/q/metrics

# Camel metrics
camel.metrics.enabled=true
camel.metrics.enable-route-policy=true
camel.metrics.enable-message-history=false
camel.metrics.enable-exchange-event-notifier=true
camel.metrics.enable-route-event-notifier=true

# -----------------------------------------------------------------------------
# OpenTelemetry Configuration
# -----------------------------------------------------------------------------
quarkus.otel.enabled=true
quarkus.otel.exporter.otlp.endpoint=http://localhost:4317
quarkus.otel.service.name=file-pipeline-integration
quarkus.otel.traces.sampler=parentbased_traceidratio
quarkus.otel.traces.sampler.arg=0.1

# Camel OpenTelemetry
camel.opentelemetry.enabled=true

# -----------------------------------------------------------------------------
# Logging Configuration
# -----------------------------------------------------------------------------
quarkus.log.console.enable=true
quarkus.log.console.format=%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c{3.}] (%t) %s%e%n
quarkus.log.console.level=INFO
quarkus.log.console.color=true

# Category-specific logging
quarkus.log.category."org.apache.camel".level=INFO
quarkus.log.category."org.apache.camel.component.jms".level=INFO
quarkus.log.category."io.quarkus".level=INFO
quarkus.log.category."org.apache.activemq".level=WARN
quarkus.log.category."software.amazon.awssdk".level=WARN

# JSON logging for production (enable via profile)
%prod.quarkus.log.console.json=true
%prod.quarkus.log.console.json.pretty-print=false

# -----------------------------------------------------------------------------
# Kubernetes Configuration
# -----------------------------------------------------------------------------
quarkus.kubernetes-config.enabled=true
quarkus.kubernetes-config.fail-on-missing-config=false
quarkus.kubernetes-config.config-maps=camel-config
quarkus.kubernetes-config.secrets.enabled=true

# Container image configuration
quarkus.container-image.group=file-pipeline
quarkus.container-image.name=camel-integration
quarkus.container-image.tag=${quarkus.application.version:latest}

# OpenShift deployment
quarkus.openshift.route.expose=false
quarkus.openshift.replicas=2
quarkus.openshift.resources.limits.cpu=2
quarkus.openshift.resources.limits.memory=2Gi
quarkus.openshift.resources.requests.cpu=250m
quarkus.openshift.resources.requests.memory=512Mi

# -----------------------------------------------------------------------------
# Dev Services (Local Development)
# -----------------------------------------------------------------------------
%dev.quarkus.artemis.devservices.enabled=true
%dev.quarkus.s3.devservices.enabled=true

# Test profile
%test.quarkus.artemis.devservices.enabled=true
%test.quarkus.s3.devservices.enabled=true
%test.quarkus.log.category."org.apache.camel".level=DEBUG
